df.sub[1,]
df[1,]
df2 = fread(paste0("~/Documents/Research/neuro-variants/output/snps/all_ld_hg38/",traitName,".all_ld.bed"),data.table = F,stringsAsFactors = F)
head(df2)
dimdf
dim(df)
dim(df2)
dim(df.sub)
head(df.sub)
head(df.sub2)
traitName="Alzheimers_Bellenguez_2022"
df = fread(paste0("~/Documents/Research/neuro-variants/output/snps/finemap/all/",traitName,".susie_all.txt"),data.table = F,stringsAsFactors = F)
df.sub = subset(df,(converged.L_10!="FALSE" & (PIP.L_10 > 0.001 | CS.L_10!=-1)) |
(converged.L_1!="FALSE" & (PIP.L_1 > 0.001 | CS.L_1!=-1)))
df.sub = df.sub[,c("chr","snp_pos","snp_pos","effect_allele","non_effect_allele","rsid")]
df.sub$chr = paste0("chr",df.sub$chr)
df.sub[,2] = df.sub[,2]-1
colnames(df.sub) <- paste0("V",1:6)
df2 = fread(paste0("~/Documents/Research/neuro-variants/output/snps/all_ld_hg38/",traitName,".all_ld.bed"),data.table = F,stringsAsFactors = F)
head(df.sub)
head(df2)
dim(df2)
dim(df.sub)
df.sub$V7 <- "FM"
df2$V7 <- "LD"
df.mg = rbind(df.sub,df2)
df.sub$V7 <- "FM"
df2$V7 <- "LD"
df.mg = as.data.frame(rbind(df.sub,df2))
head(df.mg)
dim(df.mg)
df.mg$trait = traitName
head(df.mg)
df.mg = df.mg[!duplicated(df.mg$V6),]
df.sub$V7 <- "FM"
df2$V7 <- "LD"
df.mg = as.data.frame(rbind(df.sub,df2))
df.mg = df.mg[!duplicated(df.mg$V6),]
df.mg$trait = traitName
head(df.mg)
dim(df.mg)
df.mg = as.data.frame(rbind(df.sub,df2))
dim(df.mg)
df.mg = df.mg[!duplicated(df.mg$V6),]
df.mg$trait = traitName
dim(df.mg)
dim(df.mg)
df.save = df.mg
i=10
i=9
traits = c("ADHD_Demontis_2019","ALS_Rheenen_2021","ASD_Grove_2019","Alzheimers_Bellenguez_2022",
"Anorexia_nervosa_Watson_2019","Bipolar_Mullins_2021","Major_Depression_Howard_2019",
"PTSD_Nievergelt_2019","Schizophrenia_PGC_2022","Tourette_Yu_2019")
traitName=traits[i]
traitName
df = fread(paste0("~/Documents/Research/neuro-variants/output/snps/finemap/all/",traitName,".susie_all.txt"),data.table = F,stringsAsFactors = F)
dim(df)
df.sub = subset(df,(converged.L_10!="FALSE" & (PIP.L_10 > 0.001 | CS.L_10!=-1)) |
(converged.L_1!="FALSE" & (PIP.L_1 > 0.001 | CS.L_1!=-1)))
dim(df.sub)
df.sub = df.sub[,c("chr","snp_pos","snp_pos","effect_allele","non_effect_allele","rsid")]
df.sub$chr = paste0("chr",df.sub$chr)
df.sub[,2] = df.sub[,2]-1
colnames(df.sub) <- paste0("V",1:6)
dim(df.sub)
df2 = fread(paste0("~/Documents/Research/neuro-variants/output/snps/all_ld_hg38/",traitName,".all_ld.bed"),data.table = F,stringsAsFactors = F)
dim(df2)
df.sub$V7 <- "FM"
df2$V7 <- "LD"
df.mg = as.data.frame(rbind(df.sub,df2))
df.mg = df.mg[!duplicated(df.mg$V6),]
df.mg$trait = traitName
dim(df.mg)
i
head(df.mg)
df.save2 = rbind(df.save,df.mg)
df.save2 = as.data.frame(rbind(df.save,df.mg))
head(df.save2)
sum(duplicated(df.save2))
sum(duplicated(df.save2$V6))
dim(df.save2)
which(df.save2$V6 %in% df.save2$V6[(duplicated(df.save2$V6))])
duplicated_snps = df.save2$V6[(duplicated(df.save2$V6))]
duplicated_idx = (duplicated(df.save2$V6))
duplicated_snps = df.save2$V6[duplicated_idx]
df.save2 = df.save2[!duplicated_idx,]
dim(df.save2)
df.save2$V6
df.save2$V6
which(df.save2$V6 %in% duplicated_snps)
idx = (df.save2$V6 %in% duplicated_snps)
df.save2$V7[idx] = paste0(df.save2$V7[idx],"|",traitName)
head(df.save2$V7[idx])
head(idx)
head(which(idx))
df.save2[8723:8734,]
df.save2 = as.data.frame(rbind(df.save,df.mg))
duplicated_idx = (duplicated(df.save2$V6))
duplicated_snps = df.save2$V6[duplicated_idx]
df.save2 = df.save2[!duplicated_idx,]
idx = (df.save2$V6 %in% duplicated_snps)
df.save2$V8[idx] = paste0(df.save2$V8[idx],"|",traitName)
df.save2[8723:8734,]
subset(df.save,V6=="rs62197186")
subset(df.mg,V6=="rs62197186")
traitName="Alzheimers_Bellenguez_2022"
traits = c("ADHD_Demontis_2019","ALS_Rheenen_2021","ASD_Grove_2019","Alzheimers_Bellenguez_2022",
"Anorexia_nervosa_Watson_2019","Bipolar_Mullins_2021","Major_Depression_Howard_2019",
"PTSD_Nievergelt_2019","Schizophrenia_PGC_2022","Tourette_Yu_2019")
for (i in 1:length(traits)) {
print(paste(i,traits))
traitName=traits[i]
df = fread(paste0("~/Documents/Research/neuro-variants/output/snps/finemap/all/",traitName,".susie_all.txt"),data.table = F,stringsAsFactors = F)
df.sub = subset(df,(converged.L_10!="FALSE" & (PIP.L_10 > 0.001 | CS.L_10!=-1)) |
(converged.L_1!="FALSE" & (PIP.L_1 > 0.001 | CS.L_1!=-1)))
df.sub = df.sub[,c("chr","snp_pos","snp_pos","effect_allele","non_effect_allele","rsid")]
df.sub$chr = paste0("chr",df.sub$chr)
df.sub[,2] = df.sub[,2]-1
colnames(df.sub) <- paste0("V",1:6)
df2 = fread(paste0("~/Documents/Research/neuro-variants/output/snps/all_ld_hg38/",traitName,".all_ld.bed"),data.table = F,stringsAsFactors = F)
df.sub$V7 <- "FM"
df2$V7 <- "LD"
df.mg = as.data.frame(rbind(df.sub,df2))
df.mg = df.mg[!duplicated(df.mg$V6),]
df.mg$V8 = traitName
if (i==1) {
df.save = df.mg
} else {
df.save = as.data.frame(rbind(df.save,df.mg))
duplicated_idx = (duplicated(df.save$V6))
duplicated_snps = df.save$V6[duplicated_idx]
df.save = df.save[!duplicated_idx,]
idx = (df.save$V6 %in% duplicated_snps)
df.save$V8[idx] = paste0(df.save$V8[idx],"|",traitName)
}
}
library(data.table)
traitName="Alzheimers_Bellenguez_2022"
traits = c("ADHD_Demontis_2019","ALS_Rheenen_2021","ASD_Grove_2019","Alzheimers_Bellenguez_2022",
"Anorexia_nervosa_Watson_2019","Bipolar_Mullins_2021","Major_Depression_Howard_2019",
"PTSD_Nievergelt_2019","Schizophrenia_PGC_2022","Tourette_Yu_2019")
for (i in 1:length(traits)) {
print(paste(i,traitName))
traitName=traits[i]
df = fread(paste0("~/Documents/Research/neuro-variants/output/snps/finemap/all/",traitName,".susie_all.txt"),data.table = F,stringsAsFactors = F)
df.sub = subset(df,(converged.L_10!="FALSE" & (PIP.L_10 > 0.001 | CS.L_10!=-1)) |
(converged.L_1!="FALSE" & (PIP.L_1 > 0.001 | CS.L_1!=-1)))
df.sub = df.sub[,c("chr","snp_pos","snp_pos","effect_allele","non_effect_allele","rsid")]
df.sub$chr = paste0("chr",df.sub$chr)
df.sub[,2] = df.sub[,2]-1
colnames(df.sub) <- paste0("V",1:6)
df2 = fread(paste0("~/Documents/Research/neuro-variants/output/snps/all_ld_hg38/",traitName,".all_ld.bed"),data.table = F,stringsAsFactors = F)
df.sub$V7 <- "FM"
df2$V7 <- "LD"
df.mg = as.data.frame(rbind(df.sub,df2))
df.mg = df.mg[!duplicated(df.mg$V6),]
df.mg$V8 = traitName
if (i==1) {
df.save = df.mg
} else {
df.save = as.data.frame(rbind(df.save,df.mg))
duplicated_idx = (duplicated(df.save$V6))
duplicated_snps = df.save$V6[duplicated_idx]
df.save = df.save[!duplicated_idx,]
idx = (df.save$V6 %in% duplicated_snps)
df.save$V8[idx] = paste0(df.save$V8[idx],"|",traitName)
}
}
nrow(df.save)
head(df.save)
tail(df.save)
df.save = df.save[order(df.save$V1,df.save$V2),]
head(df.save)
dim(df.save)
f.out = "/oak/stanford/groups/smontgom/amarder/neuro-variants/output/snps/comprehensive/all_gwas_snps.bed"
fwrite(df.save,f.out,quote = F,na = "NA",sep = "\t",row.names = F,col.names = F)
f.out = "~/Documents/Research/neuro-variants/output/snps/comprehensive/all_gwas_snps.bed"
# f.out = "/oak/stanford/groups/smontgom/amarder/neuro-variants/output/snps/comprehensive/all_gwas_snps.bed"
fwrite(df.save,f.out,quote = F,na = "NA",sep = "\t",row.names = F,col.names = F)
f.out = "~/Documents/Research/neuro-variants/output/snps/comprehensive/all_gwas_snps.bed"
# f.out = "/oak/stanford/groups/smontgom/amarder/neuro-variants/output/snps/comprehensive/all_gwas_snps.bed"
fwrite(df.save,f.out,quote = F,na = "NA",sep = "\t",row.names = F,col.names = F)
sum(duplicated(df.save$V6))
library(data.table)
df = fread("~/Documents/Research/t21_multiome/output/scent/out_split/all/HSCs.DE.txt",data.table = F,stringsAsFactors = F)
library(data.table)
df = fread("~/Documents/Research/t21_multiome/output/scent/out_split/all/HSCs.DE.txt",data.table = F,stringsAsFactors = F)
library(data.table)
df = fread("~/Documents/Research/t21_multiome/output/scent/out_split/all/HSCs.DE.txt",data.table = F,stringsAsFactors = F)
head(df,2)
gsub("-*","",df$peak[1])
gsub("-.*","",df$peak[1])
substring(gsub("-.*","",df$peak[1]),4)
substring(gsub("-.*","",df$peak[1:5]),4)
df$chr = as.numeric(substring(gsub("-.*","",df$peak),4))
df$chr[is.na(df$chr)][1:3]
df[is.na(df$chr)][1,]
df[is.na(df$chr),]
df[is.na(df$chr),][1,]
tmp = subset(df,fdr_t21 < 0.2)
dim(tmp)
hist(tmp$chr)
tmp = subset(df,fdr_h < 0.2)
hist(tmp$chr)
tmp = subset(df,fdr_H < 0.2)
hist(tmp$chr)
hist(as.factor(tmp$chr))
as.factor(tmp$chr)
barplot(prop.table(table(as.factor(tmp$chr))))
tmp = subset(df,fdr_t21 < 0.2)
barplot(prop.table(table(as.factor(tmp$chr))))
table(as.factor(tmp$chr))
prop.table(table(as.factor(tmp$chr)))
table(as.factor(tmp$chr))
tab = table(as.factor(tmp$chr))
head(tab)
as.data.frame(tab)
tmp = subset(df,fdr_H < 0.2)
tab = table(as.factor(tmp$chr))
df1 = as.data.frame(tab)
df$chr = as.numeric(substring(gsub("-.*","",df$peak),4))
tmp = subset(df,fdr_t21 < 0.2)
tab = table(as.factor(tmp$chr))
df1 = as.data.frame(tab)
tmp = subset(df,fdr_H < 0.2)
tab = table(as.factor(tmp$chr))
df2 = as.data.frame(tab)
df$chr = as.numeric(substring(gsub("-.*","",df$peak),4))
tmp = subset(df,fdr_t21 < 0.2)
tab = table(as.factor(tmp$chr))
df1 = as.data.frame(tab)
tmp = subset(df,fdr_H < 0.2)
tab = table(as.factor(tmp$chr))
df2 = as.data.frame(tab)
df2
df1
library(ggplot2)
df2[,2] = -1*df2[,2]
library(ggplot2)
df3 = rbind(df1,df2)
df3 = as.data.frame(rbind(df1,df2))
library(ggplot2)
head(df3)
df$chr = as.numeric(substring(gsub("-.*","",df$peak),4))
tmp = subset(df,fdr_t21 < 0.2)
tab = table(as.factor(tmp$chr))
df1 = as.data.frame(tab)
df1$type = "Ts21"
tmp = subset(df,fdr_H < 0.2)
tab = table(as.factor(tmp$chr))
df2 = as.data.frame(tab)
df2[,2] = -1*df2[,2]
df3 = as.data.frame(rbind(df1,df2))
df2$type = "H"
df2$type = "H"
df3 = as.data.frame(rbind(df1,df2))
library(ggplot2)
g <- ggplot(df3,
aes(x=name,
y=log10,
fill=Col2)) +
geom_bar(stat='identity',position='identity') +
theme_bw() +
theme(
axis.text.x=element_blank(),
panel.grid=element_blank(),
axis.title = element_blank(),
legend.title = element_blank()
)
head(df3)
g <- ggplot(df3,
aes(x=Var1,
y=Freq,
fill=type)) +
geom_bar(stat='identity',position='identity') +
theme_bw() +
theme(
axis.text.x=element_blank(),
panel.grid=element_blank(),
axis.title = element_blank(),
legend.title = element_blank()
)
g
g <- ggplot(df3,
aes(x=Var1,
y=Freq,
fill=type)) +
geom_bar(stat='identity',position='identity') +
theme_bw() +
theme(
panel.grid=element_blank(),
axis.title = element_blank(),
legend.title = element_blank()
)
g <- ggplot(df3,
aes(x=Var1,
y=Freq,
fill=type)) +
geom_bar(stat='identity',position='identity') +
theme_bw() +
theme(
panel.grid=element_blank(),
axis.title = element_blank(),
legend.title = element_blank()
) ; g
g <- ggplot(df3,
aes(x=Var1,
y=Freq,
fill=type)) +
geom_bar(stat='identity',position='identity') +
theme_bw() +
theme(
panel.grid=element_blank(),
legend.title = element_blank()
) +
geom_abline(slope=0,intercept=0,col='black') +
labs(y='Count',x='Tissue') +
scale_y_continuous(labels=c(2,0,2,4,6))
; g
g <- ggplot(df3,
aes(x=Var1,
y=Freq,
fill=type)) +
geom_bar(stat='identity',position='identity') +
theme_bw() +
theme(
panel.grid=element_blank(),
legend.title = element_blank()
) +
geom_abline(slope=0,intercept=0,col='black') +
labs(y='Count',x='Tissue') +
scale_y_continuous(labels=c(2,0,2,4,6))
g
g <- ggplot(df3,
aes(x=Var1,
y=Freq,
fill=type)) +
geom_bar(stat='identity',position='identity') +
theme_bw() +
theme(
panel.grid=element_blank(),
legend.title = element_blank()
) +
geom_abline(slope=0,intercept=0,col='black') +
labs(y='Count',x='Tissue') #+
g <- ggplot(df3,
aes(x=Var1,
y=Freq,
fill=type)) +
geom_bar(stat='identity',position='identity') +
theme_bw() +
theme(
panel.grid=element_blank(),
legend.title = element_blank()
) +
geom_abline(slope=0,intercept=0,col='black') +
labs(y='Count',x='Tissue') +
scale_fill_manual(values=col_to_use)#+
col_to_use = c("#FB8072" ,"#CBD5E8")
g <- ggplot(df3,
aes(x=Var1,
y=Freq,
fill=type)) +
geom_bar(stat='identity',position='identity') +
theme_bw() +
theme(
panel.grid=element_blank(),
legend.title = element_blank()
) +
geom_abline(slope=0,intercept=0,col='black') +
labs(y='Count',x='Tissue') +
scale_fill_manual(values=col_to_use)#+
g
g <- ggplot(df3,
aes(x=Var1,
y=Freq,
fill=type)) +
geom_bar(stat='identity',position='identity',col='black') +
theme_bw() +
theme(
panel.grid=element_blank(),
legend.title = element_blank()
) +
geom_abline(slope=0,intercept=0,col='black') +
labs(y='Count',x='Tissue') +
scale_fill_manual(values=col_to_use)#+
g <- ggplot(df3,
aes(x=Var1,
y=Freq,
fill=type)) +
geom_bar(stat='identity',position='identity',col='black') +
theme_bw() +
theme(
panel.grid=element_blank(),
legend.title = element_blank()
) +
geom_abline(slope=0,intercept=0,col='black') +
labs(y='Count',x='Tissue') +
scale_fill_manual(values=col_to_use); g#+
g <- ggplot(df3,
aes(x=Var1,
y=Freq,
fill=type)) +
geom_bar(stat='identity',position='identity')+#,col='black') +
theme_bw() +
theme(
panel.grid=element_blank(),
legend.title = element_blank()
) +
geom_abline(slope=0,intercept=0,col='black') +
labs(y='Count',x='Tissue') +
scale_fill_manual(values=col_to_use); g#+
g <- ggplot(df3,
aes(x=Var1,
y=Freq,
fill=type)) +
geom_bar(stat='identity',position='identity',col='grey') +
theme_bw() +
theme(
panel.grid=element_blank(),
legend.title = element_blank()
) +
geom_abline(slope=0,intercept=0,col='black') +
labs(y='Count',x='Tissue') +
scale_fill_manual(values=col_to_use); g#+
g <- ggplot(df3,
aes(x=Var1,
y=Freq,
fill=type)) +
geom_bar(stat='identity',position='identity',col='darkgrey') +
theme_bw() +
theme(
panel.grid=element_blank(),
legend.title = element_blank()
) +
geom_abline(slope=0,intercept=0,col='black') +
labs(y='Count',x='Tissue') +
scale_fill_manual(values=col_to_use); g#+
g <- ggplot(df3,
aes(x=Var1,
y=Freq,
fill=type)) +
geom_bar(stat='identity',position='identity',col='black') +
theme_bw() +
theme(
panel.grid=element_blank(),
legend.title = element_blank()
) +
geom_abline(slope=0,intercept=0,col='black') +
labs(y='Count',x='Tissue') +
scale_fill_manual(values=col_to_use); g#+
g <- ggplot(df3,
aes(x=Var1,
y=Freq,
fill=type)) +
geom_bar(stat='identity',position='identity',col='black') +
theme_bw() +
theme(
panel.grid=element_blank(),
legend.title = element_blank()
) +
geom_abline(slope=0,intercept=0,col='black') +
labs(y='Count',x='Chromosome') +
scale_fill_manual(values=col_to_use); g#+
df3
g <- ggplot(df3,
aes(x=Var1,
y=Freq,
fill=type)) +
geom_bar(stat='identity',position='identity',col='black') +
theme_bw() +
theme(
panel.grid=element_blank(),
legend.title = element_blank()
) +
geom_abline(slope=0,intercept=0,col='black') +
labs(y='Count',x='Chromosome') +
scale_fill_manual(values=col_to_use) +
scale_y_continuous(breaks=seq(-20,130,by=20))
g <- ggplot(df3,
aes(x=Var1,
y=Freq,
fill=type)) +
geom_bar(stat='identity',position='identity',col='black') +
theme_bw() +
theme(
panel.grid=element_blank(),
legend.title = element_blank()
) +
geom_abline(slope=0,intercept=0,col='black') +
labs(y='Count',x='Chromosome') +
scale_fill_manual(values=col_to_use) +
scale_y_continuous(breaks=seq(-20,130,by=20));g
library(data.table)
df = fread("~/Downloads/jon_011423/topic_8_and_9_genes.csv",data.table = F,stringsAsFactors = F)
head(df)
df = fread("~/Downloads/jon_011423/topic_8_and_9_genes.csv",data.table = F,stringsAsFactors = F,header = T)
head(df)
as.data.frame(df[,2])
head(df)
library(data.table)
fwrite(as.data.frame(df[,"Topic 9"]),"~/Downloads/jon_011423/topic9.txt",quote=F,sep = '\t',row.names = F,col.names = T,header=F)
library(data.table)
df = fread("~/Downloads/jon_011423/topic_8_and_9_genes.csv",data.table = F,stringsAsFactors = F,header = T)
fwrite(as.data.frame(df[,"Topic 9"]),"~/Downloads/jon_011423/topic9.txt",quote=F,sep = '\t',row.names = F,col.names = F,na = "NA")
fwrite(as.data.frame(df[,"Topic 8"]),"~/Downloads/jon_011423/topic8.txt",quote=F,sep = '\t',row.names = F,col.names = F,na = "NA")
s="CD34, SPINK2, PROM1, MLLT3, TESPA1, GATA2, GATA1, ALAS2, HBA1, HDC, ITGA2B, MPO, AZU1, SPI1, FCN1,VCAN,CTSB,NKG7, PRF1, IL2RB, IL7R, PAX5, IGHM, IRF8, CLEC4C, CLEC10A, MKI67"
geneOrder=unlist(strsplit(s,", |,"))
?df
?DotPlot
library(Seurat)
?DotPlot
